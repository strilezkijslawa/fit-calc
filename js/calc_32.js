totalRows=0;
$(document).ready(function(){
    $("#ac_addrow").click(function(){ac_addRow();});
    $("#ac_weight").keyup(function(){
        $(this).val($(this).val().replace(/,/,".").replace(/[A-Za-zА-Яа-яЁё!@#%&_='"`\\\/<> ]/,""));
        ac_calcAll();
    });
    $('.select-parent').change(function(){

    });
    ac_addRow();
});
function calc32change(select) {
    let cVal = select.val();
    let num = select.attr('data-id');
    console.log(cVal);
    $('select[data-child="'+num+'"]').html('');
    $("#calc32children").find(".sub_"+cVal).each(function(){
        $('select[data-child="'+num+'"]').append($(this).clone());
    });
    $('select[data-child="'+num+'"]').trigger("change").focus();
}
function ac_makeSublist(b,f,e,a){
    // $("body").append("<select style='display:none' id='"+b+f+"'></select>");
    // $("#"+b+f).html($("#"+f+" option"));
    // var d=$("#"+b).attr("value");
    // $("#"+f).html($("#"+b+f+" .sub_"+d).clone());
    // a=(typeof a=="undefined")?"":a;
    // $("#"+f+' option[value="'+a+'"]').attr("selected","selected");
    // $("#"+b).change(function(){
    //     var g=$("#"+b).attr("value");
    //     $("#"+f).html($("#"+b+f+" .sub_"+g).clone());
    //     if(e){$("#"+f).prepend("<option value='none'> -- Select -- </option>");}
    //     $("#"+f).trigger("change").focus();
    // });
}
function ac_addRow() {
    Row = totalRows;
    totalRows++;
    $("#ac_table").append('<tr style="display:none;" id=tr' + Row + "><td>" + totalRows + '</td><td><select id="ac_parent_' + Row + '" class="select-parent" onchange="return calc32change($(this));" style="width:24%" data-id="' + Row + '"><option value="0">...</option><option value="1">Домашние хлопоты</option><option value="2">Домашний досуг</option><option value="3">Занятия с детьми и животными</option><option value="4">Игры</option><option value="5">Перемещение</option><option value="6">Работа</option><option value="7">Работа в огороде</option><option value="8">Спорт</option><option value="9">Танцы</option></select><select data-child="' + Row + '" id="ac_child_' + Row + '" style="width:75%"><option class="sub_1" value="188">Генеральная уборка</option><option class="sub_1" value="122">Глажка белья</option><option class="sub_1" value= "92">Складывание одежды</option><option class="sub_1" value="126">Застилание постели</option><option class="sub_1" value="188">Мытье окон</option><option class="sub_1" value="234">Мытье полов</option><option class="sub_1" value= "93">Мытье посуды</option><option class="sub_1" value="215">Подметание полов и ковров</option><option class="sub_1" value="141">Вынос мусора</option><option class="sub_1" value= "78">Вытирание пыли</option><option class="sub_1" value="202">Стирка вручную</option><option class="sub_1" value="122">Развешивание одежды</option><option class="sub_1" value= "92">Складывание одежды</option><option class="sub_1" value= "92">Стояние в очереди</option><option class="sub_1" value="122">Покупка продуктов (спокойная)</option><option class="sub_1" value="260">Покупка продуктов (активная)</option><option class="sub_1" value="612">Подъем продуктов пешком по лестнице</option><option class="sub_1" value= "80">Приготовление пищи (сидя)</option><option class="sub_1" value="141">Приготовление пищи (стоя)</option><option class="sub_1" value="141">Поливка домашних растений</option><option class="sub_1" value= "84">Чтение сидя</option><option class="sub_1" value= "46">Шитье</option><option class="sub_1" value= "50">Изготовление поделок (сидя)</option><option class="sub_1" value= "80">Изготовление поделок (стоя)</option><option class="sub_1" value= "50">Разговор по телефону (сидя)</option><option class="sub_1" value= "80">Разговор по телефону (стоя)</option><option class="sub_1" value= "55">Просмотр телепередач</option><option class="sub_1" value="517">Перенос коробок</option><option class="sub_1" value="141">Упаковка коробок</option><option class="sub_1" value="260">Распаковка коробок</option><option class="sub_1" value="445">Перемещение мебели</option><option class="sub_2" value= "93">Персональная гигиена</option><option class="sub_2" value= "47">Принятие ванны</option><option class="sub_2" value= "93">Принятие душа</option><option class="sub_2" value= "47">Еда сидя</option><option class="sub_2" value= "93">Еда стоя</option><option class="sub_2" value= "93">Разговор во время еды</option><option class="sub_2" value= "93">Раздевание</option><option class="sub_2" value="141">Укладка волос</option><option class="sub_2" value= "46">Вязание</option><option class="sub_2" value= "93">Одевание</option><option class="sub_2" value="101">Работа за компьютером</option><option class="sub_2" value= "55">Просмотр телепередач</option><option class="sub_2" value= "84">Чтение сидя</option><option class="sub_2" value= "46">Сон</option><option class="sub_2" value= "30">Одевание</option><option class="sub_2" value="150">Секс (активный)</option><option class="sub_2" value= "75">Секс (пассивный)</option><option class="sub_3" value="141">Игра с детьми сидя</option><option class="sub_3" value="375">Игры с ребенком (высокая активность)</option><option class="sub_3" value="281">Игры с ребенком (умеренная активность)</option><option class="sub_3" value="141">Одевание ребенка</option><option class="sub_3" value="188">Купание ребенка</option><option class="sub_3" value="141">Кормление ребенка</option><option class="sub_3" value= "47">Сидение с ребенком на коленях</option><option class="sub_3" value="188">Перенос маленьких детей на руках</option><option class="sub_3" value="151">Прогулка с коляской</option><option class="sub_3" value="141">Кормление животных</option><option class="sub_3" value="234">Мытье животного</option><option class="sub_3" value="281">Прогулка с собакой (активная)</option><option class="sub_3" value="202">Прогулка с собакой (легкая)</option><option class="sub_3" value="169">Игры с животными (активные)</option><option class="sub_3" value="141">Игры с животными (тихие)</option><option class="sub_4" value="130">Игра в казино</option><option class="sub_4" value= "50">Игра в карты</option><option class="sub_4" value="141">Игра с детьми (сидя)</option><option class="sub_4" value="375">Игры с ребенком (высокая активность)</option><option class="sub_4" value="281">Игры с ребенком (умеренная активность)</option><option class="sub_4" value="169">Игры с животными (активные)</option><option class="sub_4" value="141">Игры с животными (тихие)</option><option class="sub_4" value= "50">Настольные игры</option><option class="sub_4" value= "80">Игра на инструменте (аккордеон)</option><option class="sub_4" value="302">Игра на инструменте (барабан)</option><option class="sub_4" value="101">Игра на инструменте (виолончель)</option><option class="sub_4" value="101">Игра на инструменте (гитара, положение сидя)</option><option class="sub_4" value="202">Игра на инструменте (гитара, положение стоя)</option><option class="sub_4" value="151">Игра на инструменте (пианино)</option><option class="sub_4" value="151">Игра на инструменте (скрипка)</option><option class="sub_4" value="151">Игра на инструменте (труба)</option><option class="sub_4" value="101">Игра на инструменте (флейта)</option><option class="sub_5" value="592">Бег (8.5 км/ч)</option><option class="sub_5" value="739">Бег (10 км/ч)</option><option class="sub_5" value="1071">Бег (15 км/ч)</option><option class="sub_5" value="592">Бег на лыжах</option><option class="sub_5" value="710">Бег на месте</option><option class="sub_5" value="664">Бег на природе</option><option class="sub_5" value="811">Бег по пересеченной местности</option><option class="sub_5" value="1424">Бег по ступенькам вверх</option><option class="sub_5" value="609">Бег трусцой</option><option class="sub_5" value="101">Вождение автомобиля</option><option class="sub_5" value="187">Вождение трактора</option><option class="sub_5" value="302">Езда на велосипеде ( 7 км/ч)</option><option class="sub_5" value="508">Езда на велосипеде (10 км/ч)</option><option class="sub_5" value="592">Езда на велосипеде (20 км/ч)</option><option class="sub_5" value="739">Езда на велосипеде (25 км/ч)</option><option class="sub_5" value="886">Езда на велосипеде (30 км/ч)</option><option class="sub_5" value="1218">Езда на велосипеде (35 км/ч)</option><option class="sub_5" value="760">Езда на велосипеде по пересеченной местности</option><option class="sub_5" value="169">Игры с животными (активные)</option><option class="sub_5" value="141">Игры с животными (тихие)</option><option class="sub_5" value="563">Пеший поход</option><option class="sub_5" value="150">Пеший туризм (3,2 км/ч)</option><option class="sub_5" value="235">Пеший туризм (4 км/ч)</option><option class="sub_5" value="815">Плавание (баттерфляй)</option><option class="sub_5" value="739">Плавание (брасс)</option><option class="sub_5" value="739">Плавание (быстрое)</option><option class="sub_5" value="815">Плавание (кроль)</option><option class="sub_5" value="592">Плавание (на спине)</option><option class="sub_5" value="445">Плавание (общее)</option><option class="sub_5" value="609">Плавание (подводное)</option><option class="sub_5" value="369">Плавание (с маской и трубкой)</option><option class="sub_5" value="710">Плавание (синхронное)</option><option class="sub_5" value="141">Поездка на мотоцикле или скутере</option><option class="sub_5" value= "50">Поездка на такси</option><option class="sub_5" value= "92">Полет на самолете</option><option class="sub_5" value="518">Подъем по лестнице</option><option class="sub_5" value="151">Прогулка с коляской</option><option class="sub_5" value="281">Прогулка с собакой (активная)</option><option class="sub_5" value="202">Прогулка с собакой (легкая)</option><option class="sub_5" value="197">Ходьба (3 км/ч) (50 шаг/мин)</option><option class="sub_5" value="208">Ходьба (3,5 км/ч) (58 шаг/мин)</option><option class="sub_5" value="232">Ходьба (4 км/ч) (66 шаг/мин)</option><option class="sub_5" value="252">Ходьба (4,5 км/ч) (75 шаг/мин)</option><option class="sub_5" value="290">Ходьба (5 км/ч) (83 шаг/мин)</option><option class="sub_5" value="346">Ходьба (5,5 км/ч) (92 шаг/мин)</option><option class="sub_5" value="386">Ходьба (6 км/ч) (100 шаг/мин)</option><option class="sub_6" value="101">Работа за компьютером</option><option class="sub_6" value="110">Работа в офисе</option><option class="sub_6" value="403">Уборка в гараже</option><option class="sub_6" value="353">Мойка и полировка автомобиля</option><option class="sub_6" value="188">Ремонт автомобиля</option><option class="sub_6" value="294">Выполнение массажа</option><option class="sub_6" value="202">Починка водопровода</option><option class="sub_6" value="369">Прочистка водостоков</option><option class="sub_6" value="353">Изготовление мебели</option><option class="sub_6" value="332">Починка мебели</option><option class="sub_6" value="353">Внутренние малярные работы</option><option class="sub_6" value="374">Наружные малярные работы</option><option class="sub_6" value="403">Слесарные работы</option><option class="sub_6" value="202">Столярные работы</option><option class="sub_6" value="445">Кровельные работы</option><option class="sub_6" value="445">Плотницкие работы</option><option class="sub_6" value="332">Укладка ковра или кафеля</option><option class="sub_6" value="353">Укладка линолеума</option><option class="sub_6" value="353">Шлифовка полов</option><option class="sub_7" value="403">Внесение удобрений на даче, компоста</option><option class="sub_7" value="369">Выкапывание ям</option><option class="sub_7" value="403">Закладка щебня</option><option class="sub_7" value="353">Обрезка деревьев и кустарника</option><option class="sub_7" value="403">Перевозка груза на тачке</option><option class="sub_7" value="353">Посадка саженцев деревьев и кустов</option><option class="sub_7" value="332">Работа в огороде (общая)</option><option class="sub_7" value="340">Работа в огороде (прополка)</option><option class="sub_7" value="294">Работа в огороде (граблями)</option><option class="sub_7" value="280">Работа в огороде (вскапывание земли)</option><option class="sub_7" value="508">Работа ручной косой</option><option class="sub_7" value="332">Работа с газонокосилкой</option><option class="sub_7" value="403">Разгрузка пиломатериалов</option><option class="sub_7" value="445">Рубка дров</option><option class="sub_7" value="445">Ручная уборка снега</option><option class="sub_7" value="369">Складывание, переноска дров</option><option class="sub_7" value="336">Уборка газона</option><option class="sub_7" value="294">Уборка листьев</option><option class="sub_7" value="369">Укладывание дерна</option><option class="sub_7" value="353">Окраска забора</option><option class="sub_8" value="302">Акваэробика</option><option class="sub_8" value="453">Альпинизм (общий)</option><option class="sub_8" value="815">Альпинизм (восхождение)</option><option class="sub_8" value="407">Аэробика (лёгкая)</option><option class="sub_8" value="517">Аэробика (интенсивная)</option><option class="sub_8" value="255">Бадминтон (в умеренном темпе)</option><option class="sub_8" value="332">Бадминтон (в среднем темпе)</option><option class="sub_8" value="485">Бадминтон (в напряженном темпе)</option><option class="sub_8" value="750">Балет</option><option class="sub_8" value="275">Бальные танцы</option><option class="sub_8" value="479">Баскетбол</option><option class="sub_8" value="592">Бег (8.5 км/ч)</option><option class="sub_8" value="739">Бег (10 км/ч)</option><option class="sub_8" value="1071">Бег (15 км/ч)</option><option class="sub_8" value="592">Бег на лыжах</option><option class="sub_8" value="710">Бег на месте</option><option class="sub_8" value="664">Бег на природе</option><option class="sub_8" value="811">Бег по пересеченной местности</option><option class="sub_8" value="1424">Бег по ступенькам вверх</option><option class="sub_8" value="609">Бег трусцой</option><option class="sub_8" value="184">Бильярд</option><option class="sub_8" value="508">Боди-билдинг</option><option class="sub_8" value="297">Бодифлекс</option><option class="sub_8" value="664">Бокс</option><option class="sub_8" value="445">Борьба</option><option class="sub_8" value="252">Боулинг</option><option class="sub_8" value="202">Велотренажер (разминка)</option><option class="sub_8" value="517">Велотренажер (средняя активность)</option><option class="sub_8" value="777">Велотренажер (высокая активность)</option><option class="sub_8" value="710">Верховая езда (галоп)</option><option class="sub_8" value="559">Верховая езда (рысь)</option><option class="sub_8" value="160">Верховая езда (шаг)</option><option class="sub_8" value="739">Водное поло</option><option class="sub_8" value="445">Водные лыжи</option><option class="sub_8" value="223">Волейбол</option><option class="sub_8" value="302">Восточные гимнастики</option><option class="sub_8" value="739">Восточные единоборства</option><option class="sub_8" value="886">Гандбол</option><option class="sub_8" value="150">Гимнастические упражнения</option><option class="sub_8" value="369">Гребля</option><option class="sub_8" value="517">Гребной тренажер (средняя активность)</option><option class="sub_8" value="151">Дартс</option><option class="sub_8" value="916">Занятия со скакалкой</option><option class="sub_8" value="223">Занятия с гантелями (умеренно)</option><option class="sub_8" value="445">Занятия с гантелями (интенсивно)</option><option class="sub_8" value="302">Езда на велосипеде ( 7 км/ч)</option><option class="sub_8" value="508">Езда на велосипеде (10 км/ч)</option><option class="sub_8" value="592">Езда на велосипеде (20 км/ч)</option><option class="sub_8" value="739">Езда на велосипеде (25 км/ч)</option><option class="sub_8" value="886">Езда на велосипеде (30 км/ч)</option><option class="sub_8" value="1218">Езда на велосипеде (35 км/ч)</option><option class="sub_8" value="760">Езда на велосипеде по пересеченной местности</option><option class="sub_8" value="302">Игры на воде</option><option class="sub_8" value="609">Катание на коньках</option><option class="sub_8" value="609">Катание на лыжах</option><option class="sub_8" value="517">Катание на роликах</option><option class="sub_8" value="369">Катание на скейтборде</option><option class="sub_8" value="445">Катание с гор на лыжах</option><option class="sub_8" value="223">Кегли</option><option class="sub_8" value="294">Керлинг</option><option class="sub_8" value="1424">Конькобежный спорт</option><option class="sub_8" value="701">Лыжный тренажер</option><option class="sub_8" value="302">Мотокросс</option><option class="sub_8" value="315">Настольный теннис (одиночный)</option><option class="sub_8" value="205">Настольный теннис (парный)</option><option class="sub_8" value="563">Пеший поход</option><option class="sub_8" value="165">Пилатес</option><option class="sub_8" value="815">Плавание (баттерфляй)</option><option class="sub_8" value="739">Плавание (брасс)</option><option class="sub_8" value="739">Плавание (быстрое)</option><option class="sub_8" value="815">Плавание (кроль)</option><option class="sub_8" value="592">Плавание (на спине)</option><option class="sub_8" value="445">Плавание (общее)</option><option class="sub_8" value="609">Плавание (подводное)</option><option class="sub_8" value="369">Плавание (с маской и трубкой)</option><option class="sub_8" value="710">Плавание (синхронное)</option><option class="sub_8" value="592">Пляжный волейбол</option><option class="sub_8" value="609">Прыжки на лыжах с трамплина</option><option class="sub_8" value="540">Прыжки через скакалку</option><option class="sub_8" value="151">Растяжка, стрейчинг</option><option class="sub_8" value="332">Ритмическая гимнастика (легкая)</option><option class="sub_8" value="592">Ритмическая гимнастика (тяжелая)</option><option class="sub_8" value="520">Силовая тренировка на тренажерах</option><option class="sub_8" value="770">Скоростной бег на коньках</option><option class="sub_8" value="270">Скоростной спуск на лыжах</option><option class="sub_8" value="302">Спортивная гимнастика</option><option class="sub_8" value="479">Спортивная ходьба</option><option class="sub_8" value="517">Степ-аэробика (легкая)</option><option class="sub_8" value="739">Степ-аэробика (интенсивная)</option><option class="sub_8" value="330">Танец живота</option><option class="sub_8" value="400">Танцы в ритме диско</option><option class="sub_8" value="240">Танцы современные</option><option class="sub_8" value="517">Теннис</option><option class="sub_8" value="369">Тренажеры типа "наездник"</option><option class="sub_8" value="151">Хатха-йога</option><option class="sub_8" value="485">Ходьба на лыжах</option><option class="sub_8" value="592">Хоккей</option><option class="sub_8" value="710">Хоккей на траве</option><option class="sub_8" value="445">Фехтование</option><option class="sub_8" value="250">Фигурное катание</option><option class="sub_8" value="202">Фрисби</option><option class="sub_8" value="517">Футбол</option><option class="sub_9" value="750">Балет</option><option class="sub_9" value="275">Бальные танцы</option><option class="sub_9" value="202">Вальс</option><option class="sub_9" value="382">Джаз</option><option class="sub_9" value="223">Медленные танцы</option><option class="sub_9" value="353">Народные танцы</option><option class="sub_9" value="353">Полька</option><option class="sub_9" value="454">Рок-н-ролл</option><option class="sub_9" value="353">Свинг</option><option class="sub_9" value="353">Степ</option><option class="sub_9" value="202">Танго</option><option class="sub_9" value="330">Танец живота</option><option class="sub_9" value="400">Танцы в ритме диско</option><option class="sub_9" value="240">Танцы современные</option><option class="sub_9" value="382">Твист</option><option class="sub_9" value="353">Фламенко</option><option class="sub_9" value="202">Фокстрот</option></select></td><td style="text-align:center"><input size=10 type=text class="ac_inp" id="ac_time_' + Row + '"></td><td style="text-align:right" id="ac_result_' + Row + '"></td></tr>');
    ac_makeSublist("ac_parent_" + Row, "ac_child_" + Row, false, "1");
    $('#ac_child_'+Row).html('');
    $("#ac_child_" + Row).change(function () {
        ac_calcAll();
    });
    $("#ac_time_" + Row).keyup(function () {
        ac_calcAll();
    });
    $("#tr" + Row).fadeIn("slow");
}
function ac_calcAll() {
    w = eval($("#ac_weight").val());
    if ((w != null) && (w > 0)) {
        tt = 0;
        rr = 0;
        for (i = 0; i < totalRows; i++) {
            t = eval($("#ac_time_" + i).val());
            if (t == null) {
                r = "";
            } else {
                c = eval($("#ac_child_" + i).val());
                if (w <= 70) {
                    r = ((c - ((70 - w) * c * 1.4444) / 100) * t / 60).toFixed(1);
                } else {
                    r = ((c + ((w - 70) * c * 1.3333) / 100) * t / 60).toFixed(1);
                }
                tt += t;
                rr += eval(r);
            }
            $("#ac_result_" + i).text(r);
        }
        $("#ac_time").text(tt);
        $("#ac_result").text(rr.toFixed(1));
    } else {
        for (i = 0; i < totalRows; i++) {
            $("#ac_result_" + i).text("");
        }
        $("#ac_time").text("");
        $("#ac_result").text("");
    }
}